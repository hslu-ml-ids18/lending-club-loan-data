---
title: "Group X - Estimate interest rate"
author: "L. Becker, A. Chebatarova, A. Kandel, A.Kusche, R. Mizrak"
date: 'Sys.Date()'
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Initialization

```{r initialization, message=FALSE, warning=FALSE, results="hide"}
rm(list=(ls()))

# Loading required packages

library(Metrics)
library(corrplot)
library(randomForest)
library(rmarkdown)
library(foreach)
library(plyr)
library(doMC)
registerDoMC(4)

#library(tidyverse)
#library(doParallel)  
#registerDoParallel()
```

```{r Data Loading}
loan_df <- read.csv(file = "loan.csv", header = TRUE)
loan_df <- cbind(id_2 = rownames(loan_df), loan_df)
rownames(loan_df) <- 1:nrow(loan_df)
loan_df$id_2 <- as.numeric(loan_df$id_2)
dataset_7 <- loan_df[which(loan_df$id_2%%8+1== 7),]
attach(dataset_7)
```

```{r validation set approach}
# setting a seed for reproducability
set.seed(7)
# We randomly split our datafram in a train and test set
trainRows = sample(1:nrow(dataset_7),0.5*nrow(dataset_7))
testRows = nrow(dataset_7) - trainRows

```

```{r Data Exploration - lm}

# lmp.fit=lm(int_rate~.,data=dataset_7)
# summary(lmp.fit)
```

```{r Data Exploration - interest rate vs loan amount}
# plotting the loan amount vs the interest rate
plot(loan_amnt ,int_rate)
# from this visualisation we can't see any clear correlation.

plot(int_rate, loan_amnt)

```

```{r Data Exploration - interest rate vs term}
# plotting the loan amount vs the term

plot(term, int_rate)
# Here we can see that the interest rate is generaly higher for 60 months loans and lower for 36 months loans.
```

```{r Data Exploration - interest rate vs grade}
# plotting the loan amount vs the grade

plot(grade, int_rate)
# The Grade seems to have a strong influence on the interest rate
plot(sub_grade, int_rate)
# We see the same but with a greater granualrity. 

```

```{r Data Exploration - interest rate vs home ownership}
# plotting the loan amount vs home ownership

plot(home_ownership, int_rate)
# Here we can see that the interest rate is generaly higher for 60 months loans and lower for 36 months loans.
```

```{r Data Exploration - interest rate vs verification_status}
# plotting the loan amount vs verification_status

plot(verification_status, int_rate)
# The verification_status seems to also have an influence on the interest rate.

```